<%= mapper_namespace %>.<%= javascript_name %> = function(obj) {
  if (!obj) {
    return null;
  }
<% properties.each do |name,prop| %><%= property_mapper_for name %>
<% end %>
  <%= cache_module %>.set('<%= javascript_name %>', obj.id,
    <%= domain_namespace %>.<%= object_name %>.create({
<%= mapping_list %>
    })
  );
  return <%= cache_module %>.get('<%= javascript_name %>', obj.id);
};